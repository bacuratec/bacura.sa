# Story 5.1: Stripe Client Payment Intent

## Status
Completed

## Story
**As a** requester,
**I want** a clear payment flow with errors handled and status updates,
**so that** I can complete payments confidently.

## Acceptance Criteria
1. إنشاء نية دفع عبر `app/api/create-payment-intent/route.js`
2. واجهة الدفع تعرض الأخطاء مترجمة بوضوح
3. حالة الدفع تُحدّث بعد النجاح ويعرض إيصال
4. لا تُرسل طلبات دفع مكررة أثناء الانتظار

## Tasks / Subtasks
- [x] ربط نموذج الدفع مع نية الدفع من الـ API
- [x] منع النقرات المكررة أثناء الدفع
- [x] عرض رسائل الأخطاء مترجمة من Stripe
- [x] تحديث واجهة المستخدم بعد نجاح الدفع

## Dev Notes
- الواجهة: `src/components/landing-components/request-service/PaymentForm.jsx`
- واجهة API: `app/api/create-payment-intent/route.js`
- مكتبة العميل: `@stripe/react-stripe-js`, `@stripe/stripe-js`
- تم إضافة `locale` لـ Stripe Elements لدعم العربية.
- تم إضافة واجهة نجاح داخلية `CheckoutForm` بدلاً من إعادة التوجيه المباشر.

### Testing
- سيناريو فشل: بطاقة غير صالحة يعرض رسالة مترجمة.
- سيناريو نجاح: عرض رسالة نجاح وتحديث الحالة في قاعدة البيانات.

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-29 | 0.1 | Initial story draft | Dev Team |
| 2025-12-29 | 1.0 | Implementation completed | Trae Agent |

## Dev Agent Record
### Agent Model Used
GPT-5-medium (Trae)

### Debug Log References
`.ai/debug-log.md`

### Completion Notes List
- N/A

### File List
- N/A

## QA Results
- Pending
